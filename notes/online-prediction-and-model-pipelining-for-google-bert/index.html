<!DOCTYPE html>
<!-- Author: CD Athuraliya -->
<html>
    <head>
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-B43RBPDS67"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-B43RBPDS67');
        </script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="Engineer. Researcher. Co-founder ConscientAI. Research Fellow LIRNEasia.">
        <meta name="keywords" content="CD Athuraliya, cdathuraliya, ConscientAI">
        <!-- Favicon from https://favicon.io/favicon-generator/ -->
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <!-- Google Fonts Work Sans -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
        <!-- Custom styles -->
        <link rel="stylesheet" href="/styles.css">
        <title>
            Online prediction and model pipelining for Google BERT - CD Athuraliya
        </title>
    </head>
    <body>
        <div class="center">
            <br>

            <p><small><a href="/">home</a>&emsp;&emsp;&emsp;<a href="/notes/">notes</a></small></p>

            <h1>Online prediction and model pipelining for Google BERT</h1>

            <p><small>March 11, 2019&mdash;Originally published on <a href="https://medium.com/@cdathuraliya/online-prediction-and-model-pipelining-for-google-bert-8ace3c85b4f6" target="_blank">Medium</a></small></p>

            <figure>
                <img src="bert.png" alt="Google BERT">
                <figcaption><small>syracuse.com/tv/2018/09/bert_ernie_gay_sesame_street.html</small></figcaption>
            </figure>

            <p>This is going to be a short one. While others <a href="https://thegradient.pub/openai-please-open-source-your-language-model/" target="_blank">argue over GPT-2</a>, we had to dig a little deeper into <a href="https://arxiv.org/abs/1810.04805" target="_blank">Google BERT</a>. If you are a follower of deep learning research, especially on the NLP side, BERT needs no introduction at this point. Since its initial release last October, dozens more resources have been added highlighting the significance of this work by Google. The <a href="https://ai.googleblog.com/2018/11/open-sourcing-bert-state-of-art-pre.html" target="_blank">official blog post</a> itself is a very good resource to understand the basics.</p>

            <p>Besides the significance, I think the code release with good documentation (a not-so-common practice in research, sadly) immensely contributed to the popularity it gained in such a short period. The <a href="https://github.com/google-research/bert" target="_blank">repository</a> covered almost all the essentials, with very few exceptions. One was online prediction support. While I was searching through the issues and pull requests, I found <a href="https://github.com/google-research/bert/issues/94#issuecomment-437883736" target="_blank">this</a> very useful issue comment. For our requirement, we had to implement an additional <a href="https://github.com/google-research/bert/pull/327" target="_blank">data processor for SST-2</a> (we used a custom version for the actual use case), a helper class for online prediction and then use them in a pipeline with multiple BERT models.</p>

            <p>Considering BERT&rsquo;s popularity in multiple downstream NLP tasks, we thought of sharing our extensions with everyone. Of course this is far from a proper code release and I wouldn&rsquo;t call it production-ready. But in case you were looking for the same thing, I hope this would help. I have added a Jupyter Notebook to demonstrate the usage of <a href="https://github.com/cdathuraliya/bert-inference/blob/master/prediction.py" target="_blank">prediction.py</a>. Hope it is simple enough, but do send a PR if you notice anything that needs to be changed.</p>

            <p>Thanks <a href="https://github.com/brightmart" target="_blank">@brightmart</a> for opening the issue and for sharing your script! Also kudos to the BERT authors for their amazing work!</p><br>
        </div>
    </body>
</html>
